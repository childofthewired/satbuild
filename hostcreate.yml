---
- name: Playbook that Creates hosts in Satellite using the Ansible Foreman Modules
  hosts: localhost
  collections:
   - theforeman.foreman
  vars:
    sat_username: "admin"
    sat_password: "redhat"
    sat_url: "https://satellite6.testlab.org"
    host_fqdn: tester.testlab.org

  tasks:
  - name: Create a host in Satellite6
    theforeman.foreman.foreman_host:
      username: "{{ sat_username }}"
      password: "{{ sat_password }}"
      server_url: "{{ sat_url }}"
      name: "{{ host_fqdn }}"
      hostgroup: "RHEL7_Dev"
      organization: "RedHat"
      location: "RDU"
      state: present
      validate_certs: no
      build: true

#  - name: Power on the built host
#    theforeman.foreman.foreman_host_power:
#      username: "{{ sat_username }}"
#      password: "{{ sat_password }}"
#      server_url: "{{ sat_url }}"
#      hostname: "{{ host_fqdn }}"
#      state: on
#      validate_certs: no